<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ุฌุฏูู ุฅูุฌุงุฒ ุงูููุธูุงุช</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200..1000&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" />
</head>

<body class="">
  <div class="p-3">
    <!-- Top row: buttons + counts -->
    <div class="flex flex-col md:flex-row justify-between gap-4 md:gap-0 mb-4">
      <!-- Buttons -->
      <div class="flex flex-wrap gap-3 md:gap-6 flex-1">
        <button type="button"
          class="h-12 bg-gradient-to-br bg-blue-500 text-white rounded-lg px-3 shadow-sm font-bold transition cursor-pointer duration-300 hover:bg-blue-400 hover:shadow-lg flex items-center gap-2">
          ุทุจุงุนุฉ ุงูุฌุฏูู
          <i class="bi bi-printer"></i>
        </button>

        <button type="button"
          class="h-12 bg-gradient-to-br bg-cyan-500 text-white rounded-lg px-3 shadow-sm font-bold transition cursor-pointer duration-300 hover:bg-cyan-400 hover:shadow-lg flex items-center gap-2">
          ุชุตุฏูุฑ ุงูุฌุฏูู ุฅูู EXCEL
          <i class="bi bi-file-earmark-spreadsheet"></i>
        </button>

        <button type="button"
          class="h-12 bg-gradient-to-br bg-red-500 text-white rounded-lg px-3 shadow-sm font-bold transition cursor-pointer duration-300 hover:bg-red-400 hover:shadow-lg flex items-center gap-2">
          ุญุฐู ูุงูู ุงูุจูุงูุงุช
          <i class="bi bi-trash3"></i>
        </button>
      </div>

      <!-- Counts -->
      <div class="w-full md:w-60 border border-gray-200 shadow-lg p-3 rounded-xl mt-3 md:mt-0">
        <div id="doneCount">๐ข ุชู ุฅูุฌุงุฒู: 0</div>
        <div id="notDoneCount">๐ด ูู ูุชู ุฅูุฌุงุฒู: 0</div>
      </div>
    </div>

    <!-- Table -->
    <div class="overflow-x-auto rounded shadow">
      <table id="employeeTable" class="min-w-full border border-gray-300 text-right">
        <thead class="bg-gray-100">
          <tr>
            <th class="border px-4 py-2">ู</th>
            <th class="border px-4 py-2">ุงูุชุงุฑูุฎ</th>
            <th class="border px-4 py-2">ุงุณู ุงููุฏุฑุณุฉ</th>
            <th class="border px-4 py-2">ุงููุฌูุฉ</th>
            <th class="border px-4 py-2">ุงูุฃุณููุจ ุงูุฅุดุฑุงูู</th>
            <th class="border px-4 py-2">ุญุงูุฉ ุงูุฅูุฌุงุฒ</th>
            <th class="border px-4 py-2">ุตูุฑุฉ ุงูุจุงุฑููุฏ</th>
            <th class="border px-4 py-2">ุงูุฅุฌุฑุงุก</th>
          </tr>
        </thead>
        <tbody id="tableBody">
          <!-- ุงูุจูุงูุงุช ุณูุชู ุฅุถุงูุชูุง ููุง -->
        </tbody>
      </table>
    </div>
  </div>

  <script src="buttonsFunctions.js"></script>
  <script>
    function updateCounts() {
      const data = JSON.parse(localStorage.getItem("employeeData") || "[]");

      // ุญุณุงุจ ุงูููุงู ุงูููุชููุฉ ูุบูุฑ ุงูููุชููุฉ
      const done = data.filter((item) => item.category == "1").length;
      const notDone = data.filter((item) => item.category == "2").length;

      // ุนุฑุถ ุงูุฃุฑูุงู
      document.getElementById(
        "doneCount"
      ).textContent = `๐ข ุชู ุฅูุฌุงุฒู: ${done}`;
      document.getElementById(
        "notDoneCount"
      ).textContent = `๐ด  ูู ูุชู ุฅูุฌุงุฒู: ${notDone}`;
    }

    // ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ ุจุนุฏ ุชุญููู ุงูุฌุฏูู
    window.addEventListener("DOMContentLoaded", updateCounts);

    function loadTable() {
      const tableBody = document.getElementById("tableBody");
      tableBody.innerHTML = ""; // ูุณุญ ุฃู ูุญุชูู ูุฏูู

      const data = JSON.parse(localStorage.getItem("employeeData") || "[]");

      data.forEach((item, index) => {
        const row = document.createElement("tr");
        row.className = "hover:bg-gray-50";

        row.innerHTML = `
                <td class="border px-4 py-2">${index + 1}</td>
                <td class="border px-4 py-2">${item.date}</td>
                <td class="border px-4 py-2">${item.name}</td>
                <td class="border px-4 py-2">${item.job}</td>
                <td class="border px-4 py-2">${item.details}</td>
                <td class="border px-4 py-2">${item.category == "1" ? "๐ข ุชู ุงูุฅูุฌุงุฒ" : "๐ด ูู ูุชู ุงูุฅูุฌุงุฒ"}</td>
                <td class="border px-4 py-2 text-center">
                    ${item.barcodeImage
            ? `<img src="${item.barcodeImage}" alt="barcode" class="w-16 h-16 mx-auto"/>`
            : ""
          }
                </td>
                <td class="border px-4 py-2 text-center">
                    <button class="bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded delete-btn">
                        ุญุฐู
                        <i class="bi bi-trash3"></i>
                    </button>
                </td>
            `;

        // ุฅุถุงูุฉ ุญุฏุซ ุฒุฑ ุงูุญุฐู
        row.querySelector(".delete-btn").addEventListener("click", () => {
          if (confirm("ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ุฌููุน ุงูุจูุงูุงุชุ")) {
            data.splice(index, 1); // ุญุฐู ูู ุงููุตูููุฉ
            localStorage.setItem("employeeData", JSON.stringify(data)); // ุชุญุฏูุซ localStorage
            loadTable(); // ุฅุนุงุฏุฉ ุชุญููู ุงูุฌุฏูู
            updateCounts();
          }
        });

        tableBody.appendChild(row);
      });
    }
    // ุชุญููู ุงูุฌุฏูู ุนูุฏ ูุชุญ ุงูุตูุญุฉ
    window.addEventListener("DOMContentLoaded", loadTable);
  </script>
</body>

</html>